@*TODO: Get id*@
@page "/editreservation"
@attribute [Authorize]

@using MeetNSeat.Client.Services
@using MeetNSeat.Client.Models
@using Blazored.SessionStorage

@inject ISessionStorageService _sessionStorage
@inject NavigationManager _nav

<main role="main" class="col-md-12 ml-sm-auto col-lg-12 px-4">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Edit reservation</h1>
    </div>
    <div class="row">
        <div class="col-md-12">
            <form>
                <div class="form-group mx-sm-3 mb-3">
                    <label for="attendees">Attendees</label>
                    <input type="text" class="form-control" @bind="@_model.Attendees">
                </div>
                <div class="form-group mx-sm-3 mb-3">
                    <label for="starttime">Start Time</label>
                    <input type="datetime" class="form-control" id="starttime" @bind="@_model.StartTime">
                </div>
                <div class="form-group mx-sm-3 mb-3">
                    <label for="endtime">End Time</label>
                    <input type="datetime" class="form-control" id="endtime" @bind="@_model.EndTime">
                </div>
                <button @onclick="EditReservations" type="button" class="btn btn-primary mb-2">Confirm Change</button>
            </form>
        </div>
    </div>
</main>

@code
{
    private ReservationModel _model = new();

    protected override async Task OnInitializedAsync()
    {
        _model = await _sessionStorage.GetItemAsync<ReservationModel>("reservation");
    }

    private async Task EditReservations()
    {
        await UserService.EditReservation(_model);
        await _sessionStorage.RemoveItemAsync("reservation");
        _nav.NavigateTo("dashboard");
    }
}